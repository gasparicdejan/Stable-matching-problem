<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">

    <title>orILP.sagews</title>
    <meta name="description" content="automatically generated from '4422991f-430f-4750-92d2-134aa1a48a24:orILP.sagews' on SageMathCloud">
    <meta name="date" content="2017-02-17T12:36:42">
    <meta data-name="smc-generated" content="version:2">

    <style>
        html {
            font-family: sans-serif;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0; padding: 0;
        }
        body {
            width: 50rem;
            counter-reset: line;
            padding: .5rem;
        }
        @media print {
          body { width: 100%; margin: 1rem 1rem 1rem 6rem; font-size: 10pt; }
        }
        pre { margin: 0; }
        div.output + pre.input { margin-top: 1rem; }
        div.output {
            border-left: .2rem solid #33a;
            padding: .3rem;
            margin-left: -.5rem;
            line-height: 1.5;
        }
        div.output img {
            max-width: 70%;
            width: auto;
            height: auto;
        }
        div.output.stdout,
        div.output.stderr,
        div.output.javascript { font-family: monospace; white-space: pre-wrap; }
        div.output.stderr { color: #F00; border-color: #F33; }

        span.sagews-output-image > img,
        span.sagews-output-html > img
        { vertical-align: top; }

        pre.input {
            border-left: .2rem solid #3a3;
            padding: .5rem;
            margin-left: -.5rem;
        }
        pre.input > code {
            display: block;
            line-height: 1.1rem;
        }
        pre.input > code:before {
            margin-left: -3rem;
            counter-increment: line;
            content: counter(line);
            display: inline-block;
            padding: 0 .3rem 0 0;
            margin-right: .5rem;
            color: #888;
            min-width: 2rem;
            text-align: right;
            user-select: none;
        }
        div.header { margin-bottom: 1rem; }
        table.header td { border: 0; }
        table.header tr>td:nth-child(2) {
            font-weight: bold;
            font-family: monospace;
        }
        table {
            border-spacing: 0;
            border-collapse: collapse;
            margin-top: .5rem;
            margin-bottom: .5rem;
            border-color: #888;
        }
        table td, table th {
            padding: .5rem;
        }
        table tr>td {
            vertical-align: top;
            border-top: .05rem solid #888;
        }
        table tr>th {
            vertical-align: bottom;
            border-bottom: .1rem solid #888;
        }
        footer {
            margin-top: 1rem;
            border-top: .1rem solid #888;
            font-size: 70%;
            color: #888;
            text-align: center;
        }
    </style>


    <!-- the styling of the highlighted code; should be printer friendly -->
    <style>
        .cm-keyword { font-weight: bold; color: #339; }
        .cm-atom { color: #666; }
        .cm-number { color: #333; }
        .cm-def { color: #333; font-weight: bold; }
        .cm-variable { color: black; }
        .cm-variable-2 { color:black; }
        .cm-variable-3 { color: black; }
        .cm-property { color: black; }
        .cm-operator { color: black; font-weight: bold; }
        .cm-comment { color: #777; }
        .cm-string { color: #333; }
        .cm-meta { color: #039; }
        .cm-qualifier { color: #666; }
        .cm-builtin { color: #393; font-weight: bold; }
        .cm-bracket { color: #666; }
        .cm-tag { color: #444; font-weight: bold; }
        .cm-attribute { color: #777; }
        .cm-error { color: #000; }
        .cm-header { font-weight: bold; }
        .cm-header-1 { font-size: 1.2rem; }
        .cm-header-2 { font-size: 1.15rem; }
        .cm-header-3 { font-size: 1.12rem; }
        .cm-header-4 { font-size: 1.1rem; }
        .cm-header-5 { font-size: 1rem; }
        .cm-em { font-style: italic; }
        .cm-strong { font-weight: bold; }
    </style>

    <script type="text/javascript">window.MathJax = {"skipStartupTypeset":false,"extensions":["tex2jax.js","asciimath2jax.js"],"jax":["input/TeX","input/AsciiMath","output/SVG"],"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"displayMath":[["$$","$$"],["\\[","\\]"]],"processEscapes":true,"ignoreClass":"tex2jax_ignore","skipTags":["script","noscript","style","textarea","pre","code"]},"TeX":{"extensions":["autoload-all.js"],"Macros":{"Bold":["\\mathbb{#1}",1],"ZZ":["\\Bold{Z}",0],"NN":["\\Bold{N}",0],"RR":["\\Bold{R}",0],"CC":["\\Bold{C}",0],"FF":["\\Bold{F}",0],"QQ":["\\Bold{Q}",0],"QQbar":["\\overline{\\QQ}",0],"CDF":["\\Bold{C}",0],"CIF":["\\Bold{C}",0],"CLF":["\\Bold{C}",0],"RDF":["\\Bold{R}",0],"RIF":["\\Bold{I} \\Bold{R}",0],"RLF":["\\Bold{R}",0],"CFF":["\\Bold{CFF}",0],"GF":["\\Bold{F}_{#1}",1],"Zp":["\\ZZ_{#1}",1],"Qp":["\\QQ_{#1}",1],"Zmod":["\\ZZ/#1\\ZZ",1]}},"HTML-CSS":{"linebreaks":{"automatic":true},"scale":80},"SVG":{"linebreaks":{"automatic":true}},"showProcessingMessages":true,"CommonHTML":{"scale":80}};</script>
    <script type="text/javascript" async
        src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML">
    </script>
</head>

<body>
<div class="header">
    <h1>orILP.sagews</h1>
    <table class="header">
    <tr><td>Author</td><td>Valentina Pucer</td></tr>
    <tr><td>Date</td><td>2017-02-17T12:36:42</td></tr>
    <tr><td>Project</td><td>4422991f-430f-4750-92d2-134aa1a48a24</td></tr>
    <tr><td>Location</td><td><a href="https://cloud.sagemath.com/projects/4422991f-430f-4750-92d2-134aa1a48a24/files/orILP.sagews">orILP.sagews</a></td></tr>
    <tr><td>Original file</td><td><a href="data:application/octet-stream;base64,77igMmFmYmExNTEtZGVhNy00ZmUwLWExMGItOThiY2NhZTQzZGRm77igCgpwID0gTWl4ZWRJbnRlZ2VyTGluZWFyUHJvZ3JhbShtYXhpbWl6YXRpb24gPSBUcnVlKQp4ID0gcC5uZXdfdmFyaWFibGUoYmluYXJ5ID0gVHJ1ZSkKCmltcG9ydCB0aW1laXQKCnN0YXJ0ID0gdGltZWl0LmRlZmF1bHRfdGltZXIoKQp0PWNwdXRpbWUoKQoKZnJvbSByYW5kb20gaW1wb3J0IHNodWZmbGUKbj0xMDAKI249NQptb3NraSA9IFtdCnplbnNrZSA9IFtdCnBhcmk9W10KZm9yIGkgaW4gcmFuZ2Uobik6CiAgICBNID0gW2ogZm9yIGogaW4gcmFuZ2UobildCiAgICBzaHVmZmxlKE0pCiAgICBtb3NraS5hcHBlbmQoTSkKICAgIFogPSBbaiBmb3IgaiBpbiByYW5nZShuKV0KICAgIHNodWZmbGUoWikKICAgIHplbnNrZS5hcHBlbmQoWikKI3ByaW50KG1vc2tpKSAjemdlbmVyaXJhbGkgc21vIG5ha2xqdcSNZW4gc2V6bmFtIHByZWZlcmVuYyB2c2FrZWdhIG1vxaFrZWdhIGluIHZzYWtlIMW+ZW5za2UKI3ByaW50KHplbnNrZSkKCnAuc2V0X29iamVjdGl2ZShzdW0oc3VtKHhbaSxqXSBmb3IgaiBpbiByYW5nZShuKSkgZm9yIGkgaW4gcmFuZ2UobikpKQoKZm9yIGkgaW4gcmFuZ2Uobik6CiAgICBwLmFkZF9jb25zdHJhaW50KHN1bSh4W2ksal0gZm9yIGogaW4gcmFuZ2UobikpPT0gMSkKZm9yIGogaW4gcmFuZ2Uobik6CiAgICBwLmFkZF9jb25zdHJhaW50KHN1bSh4W2ksal0gZm9yIGkgaW4gcmFuZ2UobikpPT0gMSkKCgpmb3IgdSwgYSBpbiBlbnVtZXJhdGUobW9za2kpOgogICAgZm9yIHYsIGIgaW4gZW51bWVyYXRlKHplbnNrZSk6CiAgICAgICAgcC5hZGRfY29uc3RyYWludChzdW0oeFt1LCBpXSBmb3IgaSBpbiBhWzphLmluZGV4KHYpXSkgKyBzdW0oeFtpLCB2XSBmb3IgaSBpbiBiWzpiLmluZGV4KHUpXSkgKyB4W3UsIHZdID49IDEpCiN6YSB2c2FrZWdhIG1vxaFrZWdhIHUgZG9iaW1vIG5qZWdvdiBzZXpuYW0gYSwgemEgdnNha28gxb5lbnNrbyB2IHBhIG5qZW4gc2V6bmFtIGIsIGEuaW5kZXgodikgYm8gdG9yZWogZG9sb8SNYWwgemdvcm5qbyBtZWpvIHByaSBtb8Wha2loLT52acWhamEgcHJpb3JpdGV0YSB0aXN0aWggxb5lbnNrLCBraSBzbyBuYSB6YcSNZXRrdQoKcC5zb2x2ZSgpCgpzID0gcC5nZXRfdmFsdWVzKHgpICNzbG92YXIgcGFyb3YgKDAgbmlzdGEgcG9yb2NlbmEsIDEgc3RhKQojcHJpbnQocykKZm9yIGtleSwgdmFsdWUgaW4gcy5pdGVtcygpOgogICAgaWYgdmFsdWU9PTE6IHBhcmkuYXBwZW5kKGtleSkKCnN0b3AgPSB0aW1laXQuZGVmYXVsdF90aW1lcigpCmNwdXRpbWUodCkKcHJpbnQoc3RvcC1zdGFydCkKCnByaW50KHBhcmkpICNwcmludCBzdGFiaWxuaWggcGFyb3YK77ihYmFiMjBmMDYtZDc5MC00ZjNhLWJhNjMtYzc4ZWZkZjQyMmE477iheyJzdGRvdXQiOiIxMDAuMCJ977iheyJzdGRvdXQiOiJcbiJ977iheyJzdGRvdXQiOiI2Ni42MzZcbiJ977iheyJzdGRvdXQiOiI2OC4wMTEzMjEwNjc4XG4ife+4oXsic3Rkb3V0IjoiWyg0MSwgMzApLCAoNTgsIDgxKSwgKDM1LCAzMyksICg5MiwgNTQpLCAoODMsIDIyKSwgKDI2LCA2MCksICg3NSwgMTUpLCAoNDgsIDI1KSwgKDYyLCA3NCksICgyMiwgODIpLCAoNzgsIDM1KSwgKDI0LCAxMCksICg5LCA5MyksICg4NiwgMTQpLCAoOCwgOTEpLCAoNDQsIDExKSwgKDc5LCA1MCksICg2NiwgMjMpLCAoNjAsIDQ4KSwgKDExLCA4OCksICg1NCwgOTQpLCAoMjMsIDYpLCAoODIsIDQ2KSwgKDM0LCA0NyksICg3MSwgNzApLCAoNzIsIDQpLCAoNjQsIDk4KSwgKDM2LCAwKSwgKDU2LCA5KSwgKDk3LCA5NyksICgzMCwgMTgpLCAoNTEsIDgpLCAoMywgNTgpLCAoNTksIDc4KSwgKDY3LCA3KSwgKDY5LCA1OSksICgxMCwgNzIpLCAoODAsIDI2KSwgKDEyLCA2MyksICgzMSwgODYpLCAoMzgsIDE5KSwgKDU1LCA3OSksICg5NiwgMzIpLCAoMjEsIDMpLCAoNTMsIDI5KSwgKDc2LCA1KSwgKDEzLCA3MyksICg0MCwgNTcpLCAoNiwgMTcpLCAoMjgsIDMxKSwgKDk1LCA4MCksICgxNywgNDMpLCAoNDksIDY2KSwgKDg1LCA2OCksICg2MSwgNDQpLCAoODEsIDI3KSwgKDI3LCA2NCksICg1LCA0MCksICg1MiwgNDEpLCAoOTgsIDUyKSwgKDQyLCA4NSksICg0LCA1NiksICg2OCwgOTYpLCAoNDcsIDM0KSwgKDkwLCAzNyksICg4OSwgOTkpLCAoNDUsIDI4KSwgKDk5LCA2NyksICg3MCwgODkpLCAoMTQsIDc1KSwgKDkxLCA2OSksICg4NywgMzYpLCAoNjMsIDcxKSwgKDMzLCAxNiksICgzNywgMTMpLCAoMiwgNDkpLCAoMjAsIDUzKSwgKDMyLCA4MyksICgxOCwgOTApLCAoMjUsIDkyKSwgKDQ2LCAyMSksICg3MywgNDIpLCAoMSwgMzkpLCAoMTYsIDYxKSwgKDE5LCA4NyksICgwLCA5NSksICgyOSwgMjQpLCAoODgsIDU1KSwgKDU3LCA0NSksICg3LCAzOCksICg0MywgMSksICgxNSwgODQpLCAoNjUsIDc2KSwgKDUwLCA3NyksICg4NCwgNjUpLCAoNzQsIDEyKSwgKDkzLCAyKSwgKDk0LCAyMCksICgzOSwgNTEpLCAoNzcsIDYyKV1cbiJ977iheyJkb25lIjp0cnVlfe+4oQoKCgoKCgoKCgoK" download="orILP.sagews">orILP.sagews</td></tr>
    <script type="text/javascript">
    var is_chrome = navigator.userAgent.indexOf('Chrome') > -1;
    var is_safari = navigator.userAgent.indexOf("Safari") > -1;
    if (is_safari && !is_chrome) {
        document.write("<tr><td colspan='2'>(when downloading, rename file to orILP.sagews)</td></tr>");
    }
    </script>
    </table>
</div>
<pre class="input"><code></code><code><span class="cm-variable">p</span> = <span class="cm-variable">MixedIntegerLinearProgram</span>(<span class="cm-variable">maximization</span> = <span class="cm-builtin">True</span>)</code><code><span class="cm-variable">x</span> = <span class="cm-variable">p</span>.<span class="cm-variable">new_variable</span>(<span class="cm-variable">binary</span> = <span class="cm-builtin">True</span>)</code><code></code><code><span class="cm-keyword">import</span> <span class="cm-variable">timeit</span></code><code></code><code><span class="cm-variable">start</span> = <span class="cm-variable">timeit</span>.<span class="cm-variable">default_timer</span>()</code><code><span class="cm-variable">t</span>=<span class="cm-variable">cputime</span>()</code><code></code><code><span class="cm-keyword">from</span> <span class="cm-variable">random</span> <span class="cm-keyword">import</span> <span class="cm-variable">shuffle</span></code><code><span class="cm-variable">n</span>=<span class="cm-number">100</span></code><code><span class="cm-comment">#n=5</span></code><code><span class="cm-variable">moski</span> = []</code><code><span class="cm-variable">zenske</span> = []</code><code><span class="cm-variable">pari</span>=[]</code><code><span class="cm-keyword">for</span> <span class="cm-variable">i</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-variable">n</span>):</code><code>    <span class="cm-variable">M</span> = [<span class="cm-variable">j</span> <span class="cm-keyword">for</span> <span class="cm-variable">j</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-variable">n</span>)]</code><code>    <span class="cm-variable">shuffle</span>(<span class="cm-variable">M</span>)</code><code>    <span class="cm-variable">moski</span>.<span class="cm-variable">append</span>(<span class="cm-variable">M</span>)</code><code>    <span class="cm-variable">Z</span> = [<span class="cm-variable">j</span> <span class="cm-keyword">for</span> <span class="cm-variable">j</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-variable">n</span>)]</code><code>    <span class="cm-variable">shuffle</span>(<span class="cm-variable">Z</span>)</code><code>    <span class="cm-variable">zenske</span>.<span class="cm-variable">append</span>(<span class="cm-variable">Z</span>)</code><code><span class="cm-comment">#print(moski) #zgenerirali smo naključen seznam preferenc vsakega moškega in vsake ženske</span></code><code><span class="cm-comment">#print(zenske)</span></code><code></code><code><span class="cm-variable">p</span>.<span class="cm-variable">set_objective</span>(<span class="cm-builtin">sum</span>(<span class="cm-builtin">sum</span>(<span class="cm-variable">x</span>[<span class="cm-variable">i</span>,<span class="cm-variable">j</span>] <span class="cm-keyword">for</span> <span class="cm-variable">j</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-variable">n</span>)) <span class="cm-keyword">for</span> <span class="cm-variable">i</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-variable">n</span>)))</code><code></code><code><span class="cm-keyword">for</span> <span class="cm-variable">i</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-variable">n</span>):</code><code>    <span class="cm-variable">p</span>.<span class="cm-variable">add_constraint</span>(<span class="cm-builtin">sum</span>(<span class="cm-variable">x</span>[<span class="cm-variable">i</span>,<span class="cm-variable">j</span>] <span class="cm-keyword">for</span> <span class="cm-variable">j</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-variable">n</span>))<span class="cm-operator">==</span> <span class="cm-number">1</span>)</code><code><span class="cm-keyword">for</span> <span class="cm-variable">j</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-variable">n</span>):</code><code>    <span class="cm-variable">p</span>.<span class="cm-variable">add_constraint</span>(<span class="cm-builtin">sum</span>(<span class="cm-variable">x</span>[<span class="cm-variable">i</span>,<span class="cm-variable">j</span>] <span class="cm-keyword">for</span> <span class="cm-variable">i</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-variable">n</span>))<span class="cm-operator">==</span> <span class="cm-number">1</span>)</code><code></code><code></code><code><span class="cm-keyword">for</span> <span class="cm-variable">u</span>, <span class="cm-variable">a</span> <span class="cm-keyword">in</span> <span class="cm-builtin">enumerate</span>(<span class="cm-variable">moski</span>):</code><code>    <span class="cm-keyword">for</span> <span class="cm-variable">v</span>, <span class="cm-variable">b</span> <span class="cm-keyword">in</span> <span class="cm-builtin">enumerate</span>(<span class="cm-variable">zenske</span>):</code><code>        <span class="cm-variable">p</span>.<span class="cm-variable">add_constraint</span>(<span class="cm-builtin">sum</span>(<span class="cm-variable">x</span>[<span class="cm-variable">u</span>, <span class="cm-variable">i</span>] <span class="cm-keyword">for</span> <span class="cm-variable">i</span> <span class="cm-keyword">in</span> <span class="cm-variable">a</span>[:<span class="cm-variable">a</span>.<span class="cm-variable">index</span>(<span class="cm-variable">v</span>)]) <span class="cm-operator">+</span> <span class="cm-builtin">sum</span>(<span class="cm-variable">x</span>[<span class="cm-variable">i</span>, <span class="cm-variable">v</span>] <span class="cm-keyword">for</span> <span class="cm-variable">i</span> <span class="cm-keyword">in</span> <span class="cm-variable">b</span>[:<span class="cm-variable">b</span>.<span class="cm-variable">index</span>(<span class="cm-variable">u</span>)]) <span class="cm-operator">+</span> <span class="cm-variable">x</span>[<span class="cm-variable">u</span>, <span class="cm-variable">v</span>] <span class="cm-operator">&gt;=</span> <span class="cm-number">1</span>)</code><code><span class="cm-comment">#za vsakega moškega u dobimo njegov seznam a, za vsako žensko v pa njen seznam b, a.index(v) bo torej določal zgornjo mejo pri moških-&gt;višja prioriteta tistih žensk, ki so na začetku</span></code><code></code><code><span class="cm-variable">p</span>.<span class="cm-variable">solve</span>()</code><code></code><code><span class="cm-variable">s</span> = <span class="cm-variable">p</span>.<span class="cm-variable">get_values</span>(<span class="cm-variable">x</span>) <span class="cm-comment">#slovar parov (0 nista porocena, 1 sta)</span></code><code><span class="cm-comment">#print(s)</span></code><code><span class="cm-keyword">for</span> <span class="cm-variable">key</span>, <span class="cm-variable">value</span> <span class="cm-keyword">in</span> <span class="cm-variable">s</span>.<span class="cm-variable">items</span>():</code><code>    <span class="cm-keyword">if</span> <span class="cm-variable">value</span><span class="cm-operator">==</span><span class="cm-number">1</span>: <span class="cm-variable">pari</span>.<span class="cm-variable">append</span>(<span class="cm-variable">key</span>)</code><code></code><code><span class="cm-variable">stop</span> = <span class="cm-variable">timeit</span>.<span class="cm-variable">default_timer</span>()</code><code><span class="cm-variable">cputime</span>(<span class="cm-variable">t</span>)</code><code><span class="cm-keyword">print</span>(<span class="cm-variable">stop</span><span class="cm-operator">-</span><span class="cm-variable">start</span>)</code><code></code><code><span class="cm-keyword">print</span>(<span class="cm-variable">pari</span>) <span class="cm-comment">#print stabilnih parov</span></code></pre>
<div class="output stdout">100.0
66.636
68.0113210678
[(41, 30), (58, 81), (35, 33), (92, 54), (83, 22), (26, 60), (75, 15), (48, 25), (62, 74), (22, 82), (78, 35), (24, 10), (9, 93), (86, 14), (8, 91), (44, 11), (79, 50), (66, 23), (60, 48), (11, 88), (54, 94), (23, 6), (82, 46), (34, 47), (71, 70), (72, 4), (64, 98), (36, 0), (56, 9), (97, 97), (30, 18), (51, 8), (3, 58), (59, 78), (67, 7), (69, 59), (10, 72), (80, 26), (12, 63), (31, 86), (38, 19), (55, 79), (96, 32), (21, 3), (53, 29), (76, 5), (13, 73), (40, 57), (6, 17), (28, 31), (95, 80), (17, 43), (49, 66), (85, 68), (61, 44), (81, 27), (27, 64), (5, 40), (52, 41), (98, 52), (42, 85), (4, 56), (68, 96), (47, 34), (90, 37), (89, 99), (45, 28), (99, 67), (70, 89), (14, 75), (91, 69), (87, 36), (63, 71), (33, 16), (37, 13), (2, 49), (20, 53), (32, 83), (18, 90), (25, 92), (46, 21), (73, 42), (1, 39), (16, 61), (19, 87), (0, 95), (29, 24), (88, 55), (57, 45), (7, 38), (43, 1), (15, 84), (65, 76), (50, 77), (84, 65), (74, 12), (93, 2), (94, 20), (39, 51), (77, 62)]
</div>
<footer>
    <div>generated 2017-02-17T12:36:42 on
    <a href="https://cloud.sagemath.com">SageMathCloud</a>
    </div>
</footer>
</body>
</html>